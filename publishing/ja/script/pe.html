<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>プログレッシブ エンハンスメント</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Guidance on using progressive enhancement techniques to ensure scripted content is accessible when scripting is not available.">
		<script>
			var page_info = {
				'category': 'Scripted Content and Forms',
				'appliesTo': ['Audiobooks*','EPUB3','EPUB2']
			};
		</script>
		<script src="/js/init.js"></script>
		<style>
			@font-face{
			    font-family: 'Bloody';
			    src: url(/fonts/BLOODY.ttf) format('truetype');
			    font-weight: normal;
			    font-style: normal;
			}
			
			
			span#secret{
				color: rgb(255, 0, 0);
			}
			
			div#revealed{
				width: 100%;
				text-align: center;
			}
			
			span.letter{
				font-family: "Bloody";
				font-size: 240%;
				font-weight: bold;
				color: rgb(255, 0, 0);
				text-shadow: rgb(0, 0, 0) 1px 1px 2px;
				animation: bleedin 2s;
				-moz-animation: bleedin 2s;
				-webkit-animation: bleedin 2s;
			}
			
			@keyframes bleedin
			{
				from { font-weight: normal; font-size: 0%; background: rgb(255,0,0); text-shadow: rgb(0,0,0) 1px 1px 50px; }
				to { font-weight: bold; font-size: 240%; background: rgb(255,255,255); text-shadow: rgb(0,0,0) 1px 1px 2px; }
			}
			
			@-moz-keyframes bleedin
			{
				from { font-weight: normal; font-size: 0%; background: rgb(255,0,0); text-shadow: rgb(0,0,0) 1px 1px 50px; }
				to { font-weight: bold; font-size: 240%; background: rgb(255,255,255); text-shadow: rgb(0,0,0) 1px 1px 2px; }
			}
			
			@-webkit-keyframes bleedin
			{
				from { font-weight: normal; font-size: 0%; background: rgb(255,0,0); text-shadow: rgb(0,0,0) 1px 1px 50px; }
				to { font-weight: bold; font-size: 240%; background: rgb(255,255,255); text-shadow: rgb(0,0,0) 1px 1px 2px; }
			}</style>
	</head>
	
	<body>
		<main>
			<section id="summary">
				<h3>要約</h3>
				
				<p>プログレッシブ エンハンスメント技術を使用すると、スクリプトが利用できない場合でもコンテンツが利用できるようになります。</p>
			</section>
			
			<section id="tech">
				<h3>テクニック</h3>
				
				<ul>
					<li>コンテンツの表示または挿入が、スクリプトに依存しないようにする。[[WCAG-1.3.1]]</li>
					<li>リンクが、スクリプトに依存しないようにする。[[WCAG-1.3.1]]</li>
				</ul>
			</section>

			<section id="ex">
				<h3>例</h3>
				<figure id="ex-01">
					<figcaption>
						<span class="label">例1 — 強化されたリンク</span>
						<p>次の例では、秘密コードはスクリプトが利用可能な場合にのみ、非表示になり、アクティブ化できるようになります。それ以外の場合は、テキストは段落の一部として表示されるため、スクリプトのサポートに関係なく、ユーザーはテキストを読むことができます。</p>
					</figcaption>
					<pre class="prettyprint linenums small"><code>&lt;p&gt;
   The &lt;span id="code"&gt;secret code&lt;/span&gt; 
   &lt;span id="secret"&gt;D E A D M A N&lt;/span&gt; had to be
   spelled out to gain passage to the pirates' lair.
&lt;/p&gt;

&lt;div id="revealed" aria-live="assertive"/&gt;

&lt;style type="text/css"&gt;

   span#secret { color: rgb(255,0,0); }
   
   div#revealed { width: 100%; text-align: center; }
   
   span.letter { 
     font-family: "Times New Roman";
     font-size: 240%;
     font-weight: bold;
     color: rgb(255,0,0);
     text-shadow: rgb(0,0,0) 1px 1px 2px;
     animation: bleedin 2s;
   }

   @keyframes bleedin {
     from {
       font-weight: normal;
       font-size: 0%;
       background: rgb(255,0,0);
       text-shadow: rgb(0,0,0) 1px 1px 50px;
     }
     to {
       font-weight: bold;
       font-size: 240%;
       background: rgb(255,255,255);
       text-shadow: rgb(0,0,0) 1px 1px 2px;
     }
   }

&lt;/style&gt;

&lt;script&gt;
   &lt;![CDATA[
   var code = document.getElementById('code');
       code.style.color = 'rgb(0,0,200)';
       code.onclick = function () { revealCode(); };
       code.setAttribute('role', 'button');
       code.setAttribute('tabindex', 0);
   
   var secret = document.getElementById('secret'); 
       secret.style.visibility = 'hidden';
       secret.style.display = 'none';
       secret.setAttribute('aria-hidden', true);
   
   function revealCode() {
     var revealed = document.getElementById('revealed');
     if (revealed.childNodes.length == 0) {
       var codeArray = 'DEADMAN'.split('');
       var i = 0;
       var revealLetters = setInterval(function(){
         if (i &lt; codeArray.length) {
            var letter = document.createElement('span');
            letter.setAttribute('class', 'letter');
            letter.appendChild(document.createTextNode(codeArray[i]));
            revealed.appendChild(letter);
            i++;
         }
         
         else { 
            clearInterval(revealLetters);
         }
       }, 300);
     }
   }
   ]]&gt;
&lt;/script&gt;</code></pre>
					<p>このコードの動作例を次に示します。</p>
					<p>海賊の隠れ家に行くには、<span id="code">秘密コード</span><span id="secret">「D E A D M A N」</span>のスペルを言わなければならなかった。</p>
					<div id="revealed" aria-live="assertive"></div>
					<script>
						//<![CDATA[
						var code = document.getElementById('code');
						code.style.color = 'rgb(0,0,200)';
						code.onclick = function () {
							revealCode();
						};
						code.setAttribute('role', 'button');
						code.setAttribute('tabindex', 0);
						
						var secret = document.getElementById('secret');
						secret.setAttribute('hidden', 'hidden');
						secret.setAttribute('aria-hidden', true);
						
						function revealCode() {
							var revealed = document.getElementById('revealed');
							if (revealed.childNodes.length == 0) {
								var codeArray = 'DEADMAN'.split('');
								var i = 0;
								var revealLetters = setInterval(function () {
									if (i < codeArray.length) {
										var letter = document.createElement('span');
										letter.setAttribute('class', 'letter');
										letter.appendChild(document.createTextNode(codeArray[i]));
										revealed.appendChild(letter);
										i++;
									} else {
										clearInterval(revealLetters);
									}
								},
								300);
							}
						}//]]>
					</script>
				</figure>
			</section>

			<section id="desc">
				<h3>解説</h3>
				
				<p>EPUB 3ではJavaScriptによるスクリプト化されたインタラクションのサポートが追加されましたが、出版物のアクセシビリティを確保するためにインタラクションの使用方法にいくつかの制約が課されています。スクリプトの基本原則はプログレッシブ エンハンスメントです。つまり、次のようになります。</p>
				
				<blockquote>
					<p>spineレベルのスクリプトを含むトップレベルのコンテンツドキュメントは、スクリプトが無効になっているか利用できない場合でも、情報の損失やその他の重大な劣化なしにユーザーが利用できるようにします。</p>
					<cite><a href="https://www.w3.org/TR/epub/#sec-scripted-spine">EPUB 3.3</a></cite>
				</blockquote>
				
				<p>Progressive enhancement does not mean that you cannot script content, but that scripting must not be 					required. It is perfectly valid, for example, to remove content from the default rendering and replace it 					with an enhanced experience when scripting is available. It is likewise permitted to augment the default 					rendering with scripted interactivity. What you must avoid doing is scripting content such that without 					the scripting the primary narrative is not available in whole or part.</p>
				
				<p>バリデーターだけではこの基準への準拠を検証することはできないため、コンテンツを作成する際には、重要な原則が遵守されているように注意しなければなりません。特に次の点に注意してください。</p>
				
				<ul>
					<li>do not include content that can only be accessed (made visible) through scripted interaction.</li>
					<li>デフォルトのレンダリングなしで、ユーザーの設定、場所、言語、またはその他の設定に基づいてコンテンツをスクリプト対応にすることはしない。</li>
					<li>スクリプトを使わなければユーザーがコンテンツ内を移動できないようにはしない（例：自分で冒険を選ぶ本）。</li>
				</ul>
				
				<p>スクリプトを追加するときは、必ず拡張する形で追加します。</p>
				
				<p>スクリプトによる拡張の一般的な例としては、コードスニペットに行番号を追加することが挙げられます。多くのコンテンツ製作者は、行番号をエミュレートするために<code>pre</code>タグ内で順序付きリストを使用することを好みますが、順序付きリストは支援技術を使用するユーザーにとっては気が散る可能性があり、CSS対応のユーザーエージェントを使用していないユーザーにとっては煩わしく見苦しいものになる可能性があります。</p>
				
				<p>Instead of hard-coding the markup, a progressive enhancement technique would be to lay out your code 					samples so that they render as expected in the default preformatted view. You can then script, or grab a 					library, that can dynamically add the ordered list tagging to the element (which is what this site does). 					This approach ensures a baseline of readability in the most basic reading scenarios, while providing a 					richer visual view for those who have more advanced user agents.</p>
			</section>
		</main>
	</body>
</html>
